Map.setOptions('SATELLITE');

//Load  Angola,Algeria, Pakistan boundary from the Large Scale International Boundary dataset.
var countries = ee.FeatureCollection('USDOS/LSIB/2013');
var country_names = countries.filter(ee.Filter.inList('name', [
  'ALGERIA', 'ANGOLA','PAKISTAN']));


//Load JRC Data
var gsw = ee.Image('JRC/GSW1_0/GlobalSurfaceWater');
var occurrence = gsw.select('occurrence').clip(country_names);
var occurrence = occurrence.updateMask(occurrence.gt(90));



occurrence = ee.Image(occurrence.divide(100).resample('bicubic'));
//var occurrence = occurrence.updateMask(occurrence.divide(100).resample('bicubic'));



// Masking part of the image and making them transparent, removing them from the analysis
// Pixels with vaue 0 in mask (image2) will be made transparent in occurrence (image1)
var mask = occurrence.mask();

//Perform closing operation 

mask = mask.focal_mode(35, 'circle', 'meters', 3);
occurrence = occurrence.mask(mask);
 

// Create constant image of 1 values ??? is that necessary???
var vector = ee.Image(1).mask(occurrence.mask())


var VIS_OCCURRENCE = {
  min:0,
  max:1,
  palette: ['red','blue']
};



Map.addLayer(vector,VIS_OCCURRENCE,'Water occurrence');



var scale = 30;

var JRCVector = occurrence.reduceToVectors({
  geometry: country_names,
  crs: occurrence.projection(),
  scale: scale,
  tileScale: 16,
  maxPixels: 1e13
})




/*Export.table.toAsset({
  collection: JRCVector, 
  description: 'JRC-waterbodies', 
  assetId: 'users/mamoscholaki/JRC-waterbodies'
})*/


/*var waterbodiesJRC = table
Map.addLayer(waterbodiesJRC.style({color: 'ff00ff', fillColor: 'ff00ff55'}), {}, 'waterbodies (JRC)')*/



/*

//Load vector data
var osm_reservoir_poly = ee.FeatureCollection("users/mamoscholaki/angola_reservoir_polygons");
var osm_reservoir_lines = ee.FeatureCollection("users/mamoscholaki/angola_reservoir_lines");
var osm_dam_poly = ee.FeatureCollection("users/mamoscholaki/angola_dam_polygons");
var osm_dam_lines = ee.FeatureCollection("users/mamoscholaki/angola_dam_lines");

Map.addLayer(osm_reservoir_poly.style({pointSize: 1, width: 1, color: 'ff00ff', fillColor: 'ff00ff88'}), {}, 'Reservoir');
//Map.addLayer(osm_reservoir_lines.style({pointSize: 1, width: 1, color: '00FFFF', fillColor: '00BFFF'}), {}, 'Reservoir lines');

Map.addLayer(osm_dam_poly.style({pointSize: 1, width: 1, color: 'FF0000', fillColor: 'FF0000'}), {}, 'Dam poly');
Map.addLayer(osm_dam_lines.style({pointSize: 1, width: 1, color: 'FF0000', fillColor: 'FF0000'}), {}, 'Dam lines');


var osm_river_lines=osm_reservoir_lines.filter(ee.Filter.inList('waterway', ['river', 'stream', 'drain', 'canal', 'drain', 'creek', 'ditch']))
Map.addLayer(osm_river_lines.style({pointSize: 1, width: 1, color: '00FFFF', fillColor: '00BFFF'}), {}, 'River lines');



*/
